<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FrontlineQSR | Upload Data</title>

  <!-- Styles -->
  <link rel="stylesheet" href="assets/styles.css" />

  <!-- ================= AUTH ================= -->
  <script src="assets/auth.js?v=7" defer></script>

  <!-- ================= DAYPART ANALYZER =================
       MUST load BEFORE app.js because app.js uses FLQSR_SHIFT
  -->
  <script src="assets/shift-analyzer.js?v=1" defer></script>

  <!-- ================= APP LOGIC ================= -->
  <script src="assets/app.js?v=9" defer></script>

  <!-- ================= ACCESS GUARD ================= -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Prevent www vs non-www logout issues
      if (location.hostname.startsWith("www.")) {
        location.replace(location.href.replace("://www.", "://"));
        return;
      }

      // Allow client OR admin
      FLQSR_AUTH.requireClientOrAdmin();
    });
  </script>
</head>

<body>

<!-- ================= HEADER ================= -->
<header class="brandbar">
  <div class="left">
    <img src="assets/frontlineqsr-logo.png" alt="FrontlineQSR Logo" />
    <div class="title">Upload Data</div>
  </div>
  <div class="right">
    <div class="pill">Client Portal</div>
    <button class="btn" onclick="FLQSR_AUTH.logout()">Logout</button>
  </div>
</header>

<!-- ================= LAYOUT ================= -->
<div class="layout">

  <!-- ========== SIDEBAR ========== -->
  <aside class="sidebar">
    <nav class="nav">
      <a href="kpis.html">KPIs</a>
      <a href="action-plan.html">Action Plan</a>
      <a href="reports.html">Reports</a>
      <a class="active" href="upload.html">Upload Data</a>
      <a href="admin.html">Admin Review</a>
    </nav>
  </aside>

  <!-- ========== MAIN CONTENT ========== -->
  <main class="main">

    <!-- ================= INTRO ================= -->
    <section class="card">
      <h1>Upload Data</h1>
      <p class="meta">
        Upload <strong>at least 3 months</strong> of combined CSV data.
        Each file should include Sales, Labor, and Transactions.
      </p>
    </section>

    <!-- ================= REQUIREMENTS ================= -->
    <section class="card">
      <h3>CSV Requirements</h3>
      <ul class="list">
        <li>File type: <strong>.csv</strong></li>
        <li>One file per month (no duplicates)</li>
        <li>
          Required columns:
          <code>Date</code>,
          <code>Location</code>,
          <code>Sales</code>,
          <code>Labor</code>,
          <code>Transactions</code>
        </li>
        <li>
          Optional (for daypart analysis):
          <code>Shift</code> OR time in <code>Date</code> (HH:MM)
        </li>
      </ul>
      <div class="helper">
        Tip: Export directly from your POS or scheduling system.
      </div>
    </section>

    <!-- ================= UPLOAD SLOTS ================= -->
    <section class="card">
      <h3>Upload Monthly Files</h3>

      <!-- app.js injects upload cards here -->
      <div class="grid-2" id="uploadSlots"></div>

      <div class="actions" style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;">
        <button class="btn primary" id="validateBtn" type="button">
          Validate & Submit
        </button>

        <button class="btn" id="resetBtn" type="button">
          Reset
        </button>
      </div>
    </section>

    <!-- ================= STATUS ================= -->
    <section class="card" id="statusPanel">
      <h3>Status</h3>
      <div id="statusText" class="meta">
        Add files for each month, then click <strong>Validate & Submit</strong>.
      </div>
      <div id="issuesList" style="margin-top:10px;"></div>
    </section>

    <!-- ================= NEXT STEPS ================= -->
    <section class="card">
      <h3>What happens next</h3>
      <ol class="list">
        <li>System validates file structure and required columns.</li>
        <li>KPIs and daypart metrics are calculated automatically.</li>
        <li>Your submission is queued for <strong>Admin Review</strong>.</li>
        <li>Once approved, KPIs and reports update.</li>
      </ol>
    </section>

  </main>
</div>

</body>
</html>
